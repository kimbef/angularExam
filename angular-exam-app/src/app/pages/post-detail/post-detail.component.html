<div class="post-detail-container">
  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-state">
    <div class="spinner"></div>
    <p>Loading post...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error" class="error-state">
    <div class="error-icon">⚠️</div>
    <p>{{ error }}</p>
    <div class="error-actions">
      <button (click)="retryLoad()" class="btn btn-primary">Try Again</button>
      <button (click)="goBack()" class="btn btn-outline">Back to Posts</button>
    </div>
  </div>

  <!-- Post Content -->
  <article *ngIf="post && !isLoading && !error" class="post-article">
    <!-- Navigation -->
    <div class="post-navigation">
      <button (click)="goBack()" class="back-btn">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" class="back-icon">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
        </svg>
        Back to Posts
      </button>
    </div>

    <!-- Post Header -->
    <header class="post-header">
      <div class="post-category-badge">{{ post.category }}</div>
      <h1 class="post-title">{{ post.title }}</h1>
      
      <div class="post-meta">
        <div class="author-section">
          <img [src]="post.author.avatar" [alt]="post.author.username" class="author-avatar">
          <div class="author-info">
            <h3 class="author-name">{{ post.author.username }}</h3>
            <div class="post-date-info">
              <span class="post-date">Published {{ post.createdAt | date:"MMMM d, y" }}</span>
              <span *ngIf="post.updatedAt !== post.createdAt" class="post-updated">
                                  • Updated {{ post.updatedAt | date:"MMM d, y" }}
              </span>
            </div>
          </div>
        </div>

        <div class="post-stats-header">
          <div class="stat">
            <svg fill="currentColor" viewBox="0 0 20 20" class="stat-icon">
              <path fill-rule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clip-rule="evenodd"></path>
            </svg>
            <span>{{ post.likes }}</span>
          </div>
          <div class="stat">
            <svg fill="currentColor" viewBox="0 0 20 20" class="stat-icon">
              <path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"></path>
            </svg>
            <span>{{ post.comments.length }}</span>
          </div>
        </div>
      </div>
    </header>

    <!-- Featured Image -->
    <div class="post-featured-image" *ngIf="post.imageUrl">
      <img [src]="post.imageUrl" [alt]="post.title" class="featured-image">
    </div>

    <!-- Post Content -->
    <div class="post-content">
      <div class="post-body">
        <p>{{ post.content }}</p>
      </div>

      <!-- Tags -->
      <div class="post-tags" *ngIf="post.tags.length > 0">
        <h4>Tags</h4>
        <div class="tags-list">
          <span *ngFor="let tag of post.tags" class="tag">
            #{{ tag }}
          </span>
        </div>
      </div>
    </div>

    <!-- Post Actions -->
    <div class="post-actions">
      <div class="interaction-buttons">
        <button
          class="action-btn like-btn"
          [class.disabled]="!currentUser"
          [disabled]="!currentUser"
          (click)="likePost()"
          [title]="currentUser ? 'Like this post' : 'Login to like posts'"
        >
          <svg fill="currentColor" viewBox="0 0 20 20" class="action-icon">
            <path fill-rule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clip-rule="evenodd"></path>
          </svg>
          <span>Like ({{ post.likes }})</span>
        </button>

        <button
          class="action-btn dislike-btn"
          [class.disabled]="!currentUser"
          [disabled]="!currentUser"
          (click)="dislikePost()"
          [title]="currentUser ? 'Dislike this post' : 'Login to dislike posts'"
        >
          <svg fill="currentColor" viewBox="0 0 20 20" class="action-icon">
            <path fill-rule="evenodd" d="M18.707 8.707a1 1 0 00-1.414-1.414L10 14.586 2.707 7.293a1 1 0 00-1.414 1.414l8 8a1 1 0 001.414 0l8-8z" clip-rule="evenodd"></path>
          </svg>
          <span>Dislike ({{ post.dislikes }})</span>
        </button>
      </div>

      <div class="share-section">
        <span class="share-label">Share this post:</span>
        <div class="share-buttons">
          <button class="share-btn" (click)="sharePost('twitter')" title="Share on Twitter">
            <svg viewBox="0 0 24 24" class="share-icon">
              <path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/>
            </svg>
          </button>
          <button class="share-btn" (click)="sharePost('facebook')" title="Share on Facebook">
            <svg viewBox="0 0 24 24" class="share-icon">
              <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
            </svg>
          </button>
          <button class="share-btn" (click)="sharePost('copy')" title="Copy link">
            <svg viewBox="0 0 24 24" class="share-icon">
              <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>
            </svg>
          </button>
        </div>
      </div>
    </div>

    <!-- Comments Section -->
    <section class="comments-section">
      <h3 class="comments-title">
        Comments ({{ post.comments.length }})
      </h3>

      <div *ngIf="!currentUser" class="login-prompt">
        <p>Please <a routerLink="/login" class="login-link">login</a> to leave a comment.</p>
      </div>

      <div *ngIf="post.comments.length === 0" class="no-comments">
        <p>No comments yet. Be the first to share your thoughts!</p>
      </div>

      <div *ngIf="post.comments.length > 0" class="comments-list">
        <div *ngFor="let comment of post.comments" class="comment">
          <div class="comment-avatar">
            <img [src]="comment.author.avatar" [alt]="comment.author.username">
          </div>
          <div class="comment-content">
            <div class="comment-header">
              <span class="comment-author">{{ comment.author.username }}</span>
              <span class="comment-date">{{ comment.createdAt | date:"MMM d, y" }}</span>
            </div>
            <p class="comment-text">{{ comment.content }}</p>
          </div>
        </div>
      </div>

      <!-- Add Comment Form -->
      <div *ngIf="currentUser" class="add-comment-section">
        <h4>Add a Comment</h4>
        <form (ngSubmit)="submitComment()" class="comment-form">
          <div class="form-group">
            <textarea
              [(ngModel)]="newComment"
              name="comment"
              class="comment-input"
              placeholder="Share your thoughts..."
              rows="3"
              [disabled]="isSubmittingComment"
              required
            ></textarea>
          </div>
          <button
            type="submit"
            class="btn btn-primary"
            [disabled]="!newComment.trim() || isSubmittingComment"
            [class.loading]="isSubmittingComment"
          >
            <span *ngIf="!isSubmittingComment">Post Comment</span>
            <span *ngIf="isSubmittingComment" class="loading-content">
              <div class="spinner"></div>
              Posting...
            </span>
          </button>
        </form>
      </div>
    </section>
  </article>
</div>
