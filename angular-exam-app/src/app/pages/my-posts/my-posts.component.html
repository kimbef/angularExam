<div class="my-posts-container">
  <div class="posts-header">
    <div class="header-content">
      <h1>My Posts</h1>
      <p>Manage and organize your content</p>
    </div>
    <div class="header-actions">
      <a routerLink="/create-post" class="btn btn-primary">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" class="btn-icon">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
        </svg>
        New Post
      </a>
    </div>
  </div>

  <!-- Filters and Search -->
  <div class="filters-section">
    <div class="search-wrapper">
      <input
        type="text"
        placeholder="Search your posts..."
        class="search-input"
        [value]="searchTerm"
        (input)="onSearchChange($event.target?.value || '')"
      >
      <svg class="search-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
      </svg>
    </div>

    <div class="filter-controls">
      <select class="filter-select" [value]="selectedFilter" (change)="onFilterChange($event.target?.value || 'all')">
        <option value="all">All Posts</option>
        <option value="published">Published</option>
        <option value="draft">Drafts</option>
      </select>

      <select class="filter-select" [value]="sortBy" (change)="onSortChange($event.target?.value || 'newest')">
        <option value="newest">Newest First</option>
        <option value="oldest">Oldest First</option>
        <option value="title">Title A-Z</option>
        <option value="likes">Most Liked</option>
      </select>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-state">
    <div class="spinner"></div>
    <p>Loading your posts...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error" class="error-state">
    <div class="error-icon">‚ö†Ô∏è</div>
    <p>{{ error }}</p>
    <button (click)="retryLoad()" class="btn btn-primary">Try Again</button>
  </div>

  <!-- Posts Content -->
  <div *ngIf="!isLoading && !error" class="posts-content">
    <!-- Empty State -->
    <div *ngIf="posts.length === 0" class="empty-state">
      <div class="empty-icon">üìù</div>
      <h3>No posts yet</h3>
      <p>Start sharing your thoughts with the community!</p>
      <a routerLink="/create-post" class="btn btn-primary">Create Your First Post</a>
    </div>

    <!-- Filtered Empty State -->
    <div *ngIf="posts.length > 0 && filteredPosts.length === 0" class="empty-state">
      <div class="empty-icon">üîç</div>
      <h3>No posts found</h3>
      <p>Try adjusting your search or filter criteria.</p>
      <button (click)="searchTerm = ''; selectedFilter = 'all'; applyFilters()" class="btn btn-outline">
        Clear Filters
      </button>
    </div>

    <!-- Posts List -->
    <div *ngIf="filteredPosts.length > 0" class="posts-list">
      <div class="results-info">
        <span>{{ filteredPosts.length }} post(s) found</span>
      </div>

      <div class="posts-grid">
        <article *ngFor="let post of filteredPosts; trackBy: trackByPostId" class="post-card">
          <div class="post-image">
            <img [src]="post.imageUrl" [alt]="post.title" loading="lazy">
            <div class="post-status" [class.published]="post.isPublished" [class.draft]="!post.isPublished">
              {{ post.isPublished ? 'Published' : 'Draft' }}
            </div>
          </div>

          <div class="post-content">
            <div class="post-meta">
              <span class="post-date">{{ post.createdAt | date:'MMM d, y' }}</span>
              <span class="post-category">{{ post.category }}</span>
            </div>

            <h3 class="post-title">
              <a [routerLink]="['/posts', post.id]">{{ post.title }}</a>
            </h3>

            <p class="post-excerpt">{{ post.excerpt }}</p>

            <div class="post-tags" *ngIf="post.tags.length > 0">
              <span *ngFor="let tag of post.tags.slice(0, 3)" class="tag">
                #{{ tag }}
              </span>
              <span *ngIf="post.tags.length > 3" class="tag-more">
                +{{ post.tags.length - 3 }} more
              </span>
            </div>

            <div class="post-stats">
              <div class="stats-row">
                <span class="stat">
                  <svg fill="currentColor" viewBox="0 0 20 20" class="stat-icon">
                    <path fill-rule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clip-rule="evenodd"></path>
                  </svg>
                  {{ post.likes }}
                </span>
                <span class="stat">
                  <svg fill="currentColor" viewBox="0 0 20 20" class="stat-icon">
                    <path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"></path>
                  </svg>
                  {{ post.comments.length }}
                </span>
              </div>
            </div>

            <div class="post-actions">
              <a [routerLink]="['/posts', post.id]" class="action-btn view-btn">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" class="action-icon">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                </svg>
                View
              </a>
              <a [routerLink]="['/edit-post', post.id]" class="action-btn edit-btn">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" class="action-icon">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                </svg>
                Edit
              </a>
              <button (click)="confirmDelete(post)" class="action-btn delete-btn">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" class="action-icon">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                </svg>
                Delete
              </button>
            </div>
          </div>
        </article>
      </div>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <div *ngIf="showDeleteModal" class="modal-overlay" (click)="cancelDelete()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>Delete Post</h3>
        <button (click)="cancelDelete()" class="modal-close">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <p>Are you sure you want to delete "<strong>{{ postToDelete?.title }}</strong>"?</p>
        <p class="warning-text">This action cannot be undone.</p>
      </div>
      <div class="modal-actions">
        <button (click)="cancelDelete()" class="btn btn-outline">Cancel</button>
        <button 
          (click)="deletePost()" 
          class="btn btn-danger"
          [disabled]="isDeleting"
          [class.loading]="isDeleting"
        >
          <span *ngIf="!isDeleting">Delete Post</span>
          <span *ngIf="isDeleting" class="loading-content">
            <div class="spinner"></div>
            Deleting...
          </span>
        </button>
      </div>
    </div>
  </div>
</div>
